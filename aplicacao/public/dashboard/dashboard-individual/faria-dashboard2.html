<!DOCTYPE html>
<html lang="ptbr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MOBANKING</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="../../imagens/logo.ico" type="image/x-icon" />
  <link rel="stylesheet" href="../../css/estilizacao-individual/faria2.css" />
  <link rel="stylesheet" href="../../css/reset.css" />
  <link rel="stylesheet" href="../../css/default.css" />
  <link rel="stylesheet" href="../../css/cardConfirmacao.css" />
  <!-- <link rel="stylesheet" href=" link do novo css "> -->
  <!-- scripts do Chart.js - 2022-1 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="obterIndicadores()">
  <div class="frame-aplicacao" style="display: flex">
    <nav class="menu-lateral" onmouseenter="exibirMenu()" onmouseleave="ocultarMenu()">
      <img src="../../imagens/mobank-logo-menu-lateral.svg" alt="Logo" class="logo-menu">
      <ul id="menuLateralBox">

        <li class="dashboard-item">
          <a href="javascript:void(0);" onclick="toggleSubmenuServidores()">
            <span class="icon-menu"><i class="fa-solid fa-server"></i></span>
            <span class="titulo-link-menu">Servidores </span> <i class="fa-solid setaMenuServidores fa-sort-down"></i>
          </a>
        </li>

        <div class="submenuServidores" onmouseenter="manterSubmenu()" onmouseleave="fecharSubmenu()">
          <li><a href="../card.html">Máquinas</a></li>
          <li><a href="../dashboard-individual/maikon-dashboard.html">Status hardware</a></li>
          <li><a href="../dashboard-individual/joao-dashboard.html">Previsão de Alertas</a></li>
        </div>


        <li>
          <a href="../alertas.html" href="javascript:void(0);">
            <span class="icon-menu"><i class="fa-solid fa-triangle-exclamation"></i></span>
            <span class="titulo-link-menu">Alertas</span>
          </a>
        </li>
        <li class="dashboard-item">
          <a href="javascript:void(0);" onclick="toggleSubmenu()">
            <span class="icon-menu"><i class="fa-solid fa-chart-pie"></i></span>
            <span class="titulo-link-menu">Dashboard </span> <i class="fa-solid setaMenu fa-sort-down"></i>
          </a>
        </li>
        <div class="submenu" onmouseenter="manterSubmenu()" onmouseleave="fecharSubmenu()">
          <li><a href="../dashboard-individual/fabio-dashboard.html">Picos de Horário</a></li>
          <li><a href="../dashboard-individual/kaua-dashboard.html">Alertas Mensais</a></li>
          <li><a href="../dashboard-individual/faria-dashboard.html">Panorama anual</a></li>
          <li><a href="../dashboard.html">Média de uso</a></li>
        </div>
      </ul>

      <div class="name-menu">
        <a href="../usuarioInfo.html">
          <h2 id="nome_perfil_menu"></h2>
        </a>
      </div>

      <a class="buttonSair-menu" href="../../index.html">
        <h2>Sair</h2>
      </a>
    </nav>
    <div class="conteudo">
      <h1>Histórico de atividade</h1>
      <div class="board">
        <a href="faria-dashboard.html"><img src="../../imagens/Faria-individual-seta.svg" alt="" /></a>
        <div class="top">
          <div class="info">
            <h1>
              <img src="../../imagens/Faria-Individual-icone_servidor.svg" alt="" />Servidores
            </h1>
            <span>Mais gerou alertas: <span class="retorno" id="serv_mais_alertas"></span></span>
            <span>Menos gerou alertas: <span class="retorno" id="serv_menos_alertas"></span></span>

          </div>
          <hr />
          <div class="info">
            <h1>
              <img src="../../imagens/Faria-Individual-icone_compnentes.svg" alt="" />Componentes
            </h1>
            <span>Mais causou alertas: <span class="retorno" id="comp_mais_alertas"></span></span>
            <span>Menos causou alertas: <span class="retorno" id="comp_menos_alertas"></span></span>

          </div>
        </div>
        <hr class="line" />
        <div class="midle">
          <div class="title">
            <h2>Servidores que mais geraram alertas por componente:</h2>
          </div>
          <div class="content">
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_cpu.svg" alt="" />CPU:
              </h2>
              <span class="retorno" id="serv_mais_alertas_cpu"></span>
            </div>
            <hr />
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_ram.svg" alt="" />RAM:
              </h2>
              <span class="retorno" id="serv_mais_alertas_ram"></span>
            </div>
            <hr />
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_disco.svg" alt="" />Disco:
              </h2>
              <span class="retorno" id="serv_mais_alertas_disco"></span>
            </div>
            <hr />
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_rede.svg" alt="" />Rede:
              </h2>
              <span class="retorno" id="serv_mais_alertas_rede"></span>
            </div>
          </div>
        </div>
        <hr class="line" />
        <div class="bottom">
          <div class="title">
            <h2>Servidores que menos geraram alertas por componente:</h2>
          </div>
          <div class="content">
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_cpu.svg" alt="" />CPU:
              </h2>
              <span class="retorno" id="serv_menos_alertas_cpu"></span>
            </div>
            <hr />
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_ram.svg" alt="" />RAM:
              </h2>
              <span class="retorno" id="serv_menos_alertas_ram"></span>
            </div>
            <hr />
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_disco.svg" alt="" />Disco:
              </h2>
              <span class="retorno" id="serv_menos_alertas_disco"></span>
            </div>
            <hr />
            <div class="componente">
              <h2>
                <img src="../../imagens/Faria-Individual-icone_rede.svg" alt="" />Rede:
              </h2>
              <span class="retorno" id="serv_menos_alertas_rede"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>

<script>
  function obterIndicadores() {
    const empresa = sessionStorage.ID_EMPRESA
    fetch(`/faria/obterIndicadores/${empresa}`, {
      method: "GET",
    })
      .then(function (resposta) {
        if (resposta.status == 204) {
          throw "Nenhum resultado encontrado!!";
        }
        resposta.json().then((dados) => {
          console.log(dados);
          dados.forEach((registro) => {

            serv_mais_alertas.innerHTML = registro.servidor_mais_alertas
            serv_menos_alertas.innerHTML = registro.servidor_menos_alertas
            comp_mais_alertas.innerHTML = registro.componente_mais_alertas
            comp_menos_alertas.innerHTML = registro.componente_menos_alertas
            serv_mais_alertas_cpu.innerHTML = registro.servidor_mais_alertas_cpu
            serv_mais_alertas_ram.innerHTML = registro.servidor_mais_alertas_ram
            serv_mais_alertas_rede.innerHTML = registro.servidor_mais_alertas_disco
            serv_mais_alertas_disco.innerHTML = registro.servidor_mais_alertas_rede
            serv_menos_alertas_cpu.innerHTML = registro.servidor_menos_alertas_cpu
            serv_menos_alertas_ram.innerHTML = registro.servidor_menos_alertas_ram
            serv_menos_alertas_rede.innerHTML = registro.servidor_menos_alertas_disco
            serv_menos_alertas_disco.innerHTML = registro.servidor_menos_alertas_rede

          });
        });
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
      });
  }

  function exibirMenu() {
    const menuLateral = document.querySelector(".menu-lateral");
    menuLateral.classList.add("menu-aberto");
  }

  function ocultarMenu() {
    const submenu = document.querySelector(".submenu");
    const seta = document.querySelector(".fa-sort-down");

    // Fecha o submenu e redefine o ícone de seta quando o mouse sai do nav
    submenu.style.display = "none";
    seta.classList.remove("girarSeta");
    submenuAberto = false;
  }

  function toggleSubmenu() {
    const submenu = document.querySelector(".submenu");
    const seta = document.querySelector(".fa-sort-down");

    submenu.style.display =
      submenu.style.display === "block" ? "none" : "block";
    submenuAberto = submenu.style.display === "block";

    if (submenuAberto) {
      seta.classList.add("girarSeta");
    } else {
      seta.classList.remove("girarSeta");
    }
  }

  const menuLaterealHTML = document.getElementById("menuLateralBox");
  var sessTipoUsuario = sessionStorage.ID_TIPO_USUARIO;
  if (sessTipoUsuario == 1) {
    menuLaterealHTML.innerHTML += `
     <li>
          <a href="../funcionarios.html">
            <span class="icon-menu"><i class="fa-solid fa-user"></i></span>
            <span class="titulo-link-menu">Funcionários</span>
          </a>
        </li>
    `;
  }

  nome_perfil_menu.innerHTML = sessionStorage.NOME_USUARIO;
</script>